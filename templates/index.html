<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dyson Sphere Planner - Cosmic Engineering Interface</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="stars"></div>
    <div class="twinkling"></div>
    
    <div class="container">
        <header>
            <h1>Dyson Sphere Planner</h1>
            <p class="subtitle">Cosmic Engineering Interface</p>
        </header>

        <!-- User Variable Controls -->
        <form id="variable-controls" class="variable-controls">
            <fieldset>
                <legend>Core Construction</legend>
                <label title="The percentage of the sun's mass to use for construction.">Material Extraction (% of solar mass):
                    <span class="tooltip-icon" data-tooltip="How much of the sun's mass is used for construction. Higher values mean more material, but also more risk and engineering challenge.">?</span>
                    <input type="range" id="extraction_pct" min="0.1" max="10" step="0.1" value="1" title="Adjust how much of the sun's mass is extracted for the Dyson Sphere.">
                    <span id="extraction_pct_val">1</span>%
                </label>
                <label title="Multiplier for the mass that must be transported. Higher values increase transport requirements.">Transport Mass Multiplier:
                    <span class="tooltip-icon" data-tooltip="A multiplier for the mass that must be transported from the sun to the construction site. Higher values increase logistical challenge.">?</span>
                    <input type="number" id="transport_mass_mult" min="0.1" max="5" step="0.1" value="1" title="Set the multiplier for the mass that must be transported.">
                </label>
                <label title="Assembly efficiency. 1 is default, higher is better.">Assembly Efficiency (1=default, &gt;1=better):
                    <span class="tooltip-icon" data-tooltip="How efficiently components are assembled. Higher values mean faster, more resource-efficient construction.">?</span>
                    <input type="number" id="assembly_eff" min="0.1" max="5" step="0.1" value="1" title="Set the efficiency of assembly operations.">
                </label>
                <label title="Thermal management efficiency. 1 is default, higher is better.">Thermal Management Efficiency (1=default, &gt;1=better):
                    <span class="tooltip-icon" data-tooltip="How well the structure manages heat. Higher values mean better heat dissipation and system stability.">?</span>
                    <input type="number" id="thermal_eff" min="0.1" max="5" step="0.1" value="1" title="Set the efficiency of thermal management systems.">
                </label>
            </fieldset>
            <fieldset>
                <legend>Colony</legend>
                <label title="Initial population of the colony.">Initial Population:
                    <span class="tooltip-icon" data-tooltip="The number of people starting in the Dyson Sphere colony. Affects early growth and resource needs.">?</span>
                    <input type="number" id="colony_init_pop" min="10" max="100000" step="10" value="1000" title="Set the starting population for the colony.">
                </label>
                <label title="Annual growth rate of the colony population (percent).">Annual Growth Rate (%):
                    <span class="tooltip-icon" data-tooltip="The yearly percentage increase in colony population. Influences expansion and resource consumption.">?</span>
                    <input type="number" id="colony_growth_rate" min="0.1" max="10" step="0.1" value="2" title="Set the annual population growth rate for the colony.">
                </label>
                <label title="Maximum number of people the life support system can sustain.">Life Support Cap:
                    <span class="tooltip-icon" data-tooltip="The maximum population the life support systems can handle. Exceeding this risks collapse.">?</span>
                    <input type="number" id="colony_life_cap" min="1000" max="10000000" step="1000" value="1000000" title="Set the maximum supported population for the colony.">
                </label>
                <label title="Maximum amount of resources the colony can store.">Resource Cap:
                    <span class="tooltip-icon" data-tooltip="The maximum amount of resources the colony can store at once. Affects sustainability and expansion.">?</span>
                    <input type="number" id="colony_resource_cap" min="1000" max="10000000" step="1000" value="500000" title="Set the maximum resource storage for the colony.">
                </label>
            </fieldset>
            <fieldset>
                <legend>Galactic Expansion</legend>
                <label title="Speed of probes as a fraction of the speed of light.">Probe Speed (fraction of c):
                    <span class="tooltip-icon" data-tooltip="How fast your probes travel, as a fraction of the speed of light. Faster probes reach new stars sooner.">?</span>
                    <input type="number" id="probe_speed" min="0.01" max="1" step="0.01" value="0.1" title="Set the speed of probes as a fraction of the speed of light.">
                </label>
                <label title="Time required to build and launch each probe (years).">Probe Build/Launch Time (years):
                    <span class="tooltip-icon" data-tooltip="How long it takes to build and launch each probe. Affects the pace of exploration.">?</span>
                    <input type="number" id="probe_build_time" min="1" max="200" step="1" value="50" title="Set the build and launch time for each probe.">
                </label>
                <label title="Construction speed modifier. Higher values mean faster construction due to better tools, training, or technology.">Construction Speed Modifier:
                    <span class="tooltip-icon" data-tooltip="A multiplier for construction speed. Increase this to represent better tools, training, or advanced technology. 1 is default.">?</span>
                    <input type="number" id="construction_speed_mod" min="0.1" max="5" step="0.1" value="1" title="Set the construction speed modifier.">
                </label>
            </fieldset>
            <fieldset>
                <legend>Advanced/Exotic</legend>
                <label title="Size of the quantum network for advanced/exotic construction.">Quantum Network Size:
                    <span class="tooltip-icon" data-tooltip="The scale of your quantum communication network. Larger networks enable more advanced coordination and computation.">?</span>
                    <input type="number" id="quantum_network_size" min="1" max="10000" step="1" value="1000" title="Set the size of the quantum network.">
                </label>
                <label title="Volume of exotic matter available for construction.">Exotic Matter Volume:
                    <span class="tooltip-icon" data-tooltip="The amount of exotic matter available. Required for advanced and speculative engineering feats.">?</span>
                    <input type="number" id="exotic_matter_vol" min="1" max="1000000000" step="1000" value="1000000" title="Set the available volume of exotic matter.">
                </label>
                <label title="Number of pocket universes accessible for construction.">Pocket Universes:
                    <span class="tooltip-icon" data-tooltip="The number of alternate universes you can access for resources or expansion. Enables truly cosmic engineering.">?</span>
                    <input type="number" id="pocket_universes" min="0" max="1000" step="1" value="0" title="Set the number of pocket universes accessed.">
                </label>
                <label title="Number of extra dimensions accessed for construction.">Dimensions Accessed:
                    <span class="tooltip-icon" data-tooltip="How many extra dimensions your civilization can access. More dimensions unlock new possibilities.">?</span>
                    <input type="number" id="dimensions_accessed" min="1" max="20" step="1" value="1" title="Set the number of extra dimensions accessed.">
                </label>
                <label title="Target level for AI evolution (higher = more advanced AI).">AI Evolution Target Level:
                    <span class="tooltip-icon" data-tooltip="The sophistication of your AI. Higher levels enable more automation, creativity, and risk.">?</span>
                    <input type="number" id="ai_evolution_level" min="1" max="10" step="0.1" value="2" title="Set the target AI evolution level.">
                </label>
            </fieldset>
            <button type="button" id="reset-variables" title="Reset all variables to their default values."><span class="tooltip-icon" data-tooltip="Reset all input fields to their original default values.">?</span>Reset to Default</button>
        </form>

        <div class="control-panel">
            <div class="strategy-selector">
                <h2>Construction Strategy <span class="tooltip-icon" data-tooltip="Choose the overall approach for building your Dyson Sphere. Each strategy offers unique challenges and benefits.">?</span></h2>
                <select id="strategy" title="Choose the overall construction strategy for your Dyson Sphere.">
                    <option value="swarm">Dyson Swarm</option>
                    <option value="ring">Dyson Ring</option>
                    <option value="bubble">Dyson Bubble</option>
                    <option value="quantum">Quantum-Entangled</option>
                    <option value="temporal">Time-Manipulated</option>
                    <option value="exotic">Exotic Matter</option>
                    <option value="cosmic">Cosmic Engineering</option>
                    <option value="dimensional">Dimensional</option>
                    <option value="singularity">Post-Singularity</option>
                    <option value="omniversal">Omniversal</option>
                </select>
            </div>

            <div class="options">
                <label title="Include a self-sustaining colony as part of the construction plan.">
                    <span class="tooltip-icon" data-tooltip="Toggle to include a self-sustaining colony in your Dyson Sphere plan. This affects resource and population calculations.">?</span>
                    <input type="checkbox" id="include-colony" title="Toggle to include a colony in your plan.">
                    Include Colony Setup
                </label>
                <div class="year-input">
                    <label for="start-year" title="The year construction begins.">Start Year:
                        <span class="tooltip-icon" data-tooltip="Set the year when construction of your Dyson Sphere begins.">?</span>
                    </label>
                    <input type="number" id="start-year" value="2024" min="2024" title="Set the starting year for construction.">
                </div>
            </div>

            <button id="generate-plan" class="glow-button" title="Generate a new Dyson Sphere construction plan with the selected options."><span class="tooltip-icon" data-tooltip="Generate a new plan using all the parameters you've set above.">?</span>Generate Plan</button>
        </div>

        <!-- New Feature Controls -->
        <!-- <div class="feature-controls">
            <div class="feature-tabs">
                <button class="tab active" data-tab="alien">Alien Diplomacy</button>
                <button class="tab" data-tab="evolution">Universe Evolution</button>
                <button class="tab" data-tab="custom">Custom Megastructure</button>
                <button class="tab" data-tab="virtual">Virtual Civilization</button>
            </div>
            <div class="feature-section" id="tab-alien">
                <h2>Alien Diplomacy <span class="tooltip-icon" data-tooltip="Interact with advanced alien civilizations. Negotiate, trade, or defend your sphere from cosmic rivals.">?</span></h2>
                <div class="alien-controls">
                    <button id="check-alien-contacts" title="Check for new or existing alien civilizations making contact."><span class="tooltip-icon" data-tooltip="Scan for new alien encounters and review your current diplomatic status.">?</span>Check for Alien Contacts</button>
                    <div id="alien-contacts-list" class="event-list"></div>
                </div>
            </div>
            <div class="feature-section" id="tab-evolution">
                <!-- Universe Evolution content here -->
            </div>
            <div class="feature-section" id="tab-custom">
                <!-- Custom Megastructure content here -->
            </div>
            <div class="feature-section" id="tab-virtual">
                <!-- Virtual Civilization content here -->
            </div>
        </div> -->

        <div class="results" style="display: none;">
            <div class="metrics-panel">
                <h2>Construction Metrics</h2>
                <div class="metrics-grid">
                    <div class="metric">
                        <span class="label">Total Time</span>
                        <span class="value" id="total-time">-</span>
                    </div>
                    <div class="metric">
                        <span class="label">Completion Year</span>
                        <span class="value" id="completion-year">-</span>
                    </div>
                    <div class="metric">
                        <span class="label">Total Mass</span>
                        <span class="value" id="total-mass">-</span>
                    </div>
                    <div class="metric">
                        <span class="label">Energy Required</span>
                        <span class="value" id="total-energy">-</span>
                    </div>
                </div>
            </div>

            <div class="advanced-metrics" style="display: none;">
                <h2>Advanced Metrics</h2>
                <div class="metrics-grid">
                    <div class="metric">
                        <span class="label">Pocket Universes</span>
                        <span class="value" id="pocket-universes">-</span>
                    </div>
                    <div class="metric">
                        <span class="label">Black Holes</span>
                        <span class="value" id="black-holes">-</span>
                    </div>
                    <div class="metric">
                        <span class="label">Dimensions</span>
                        <span class="value" id="dimensions">-</span>
                    </div>
                    <div class="metric">
                        <span class="label">Consciousness Uploads</span>
                        <span class="value" id="consciousness-uploads">-</span>
                    </div>
                    <div class="metric">
                        <span class="label">AI Evolution</span>
                        <span class="value" id="ai-evolution">-</span>
                    </div>
                    <div class="metric">
                        <span class="label">Digital Realities</span>
                        <span class="value" id="digital-realities">-</span>
                    </div>
                </div>
            </div>

            <div class="phases-panel">
                <h2>Construction Phases</h2>
                <div class="phases-timeline" id="phases-timeline"></div>
            </div>

            <div class="orbital-grid">
                <h2>Orbital Structure</h2>
                <div class="visualization-header">
                    <span id="current-year">Year: 2024</span>
                    <div class="progress-container">
                        <div id="construction-progress"></div>
                    </div>
                </div>
                <div id="orbital-grid" class="grid-container"></div>
                <div id="current-year-events" class="current-year-events-box"></div>
                <div class="grid-legend">
                    <div class="legend-item"><span class="symbol collector">O</span> Collector</div>
                    <div class="legend-item"><span class="symbol habitat">#</span> Habitat</div>
                    <div class="legend-item"><span class="symbol resource">R</span> High Resource</div>
                    <div class="legend-item"><span class="symbol resource">r</span> Medium Resource</div>
                    <div class="legend-item"><span class="symbol transport">T</span> High Traffic</div>
                    <div class="legend-item"><span class="symbol transport">t</span> Medium Traffic</div>
                    <div class="legend-item"><span class="symbol thermal">H</span> Hot Zone</div>
                    <div class="legend-item"><span class="symbol thermal">C</span> Cool Zone</div>
                </div>
            </div>
        </div>

        <!-- Add this right after the simulation results section, before the closing main div -->
        <div class="section" id="story-section">
            <h2>Simulation Story</h2>
            <div class="story-container">
                <div id="story-content" class="story-text"></div>
                <div id="story-loading" class="story-loading" style="display:none;">Generating story...</div>
            </div>
        </div>
    </div>

    <style>
        .story-container {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #00ff00;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
        }

        .story-text {
            color: #00ff00;
            font-family: 'Courier New', monospace;
            line-height: 1.6;
            text-align: justify;
            white-space: pre-wrap;
        }

        #generate-story {
            background: linear-gradient(45deg, #00ff00, #00cc00);
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 10px 0;
        }

        #generate-story:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.4);
        }

        #generate-story:active {
            transform: scale(0.95);
        }

        .current-year-events-box {
            margin: 1.5rem 0 2rem 0;
            padding: 1rem 1.5rem;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ffea;
            border-radius: 10px;
            color: #00ffea;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            min-height: 2.5rem;
            box-shadow: 0 0 16px #00ffea44;
            transition: background 0.3s;
        }
        .current-year-events-box .event-entry {
            margin-bottom: 0.5rem;
        }
    </style>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        // Add this to your existing JavaScript
        function generateStory() {
            const button = document.getElementById('generate-story');
            button.disabled = true;
            button.textContent = 'Generating Story...';
            
            fetch('/generate_story', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    strategy: document.getElementById('strategy').value,
                    start_year: parseInt(document.getElementById('start-year').value),
                    include_colony: document.getElementById('include-colony').checked
                })
            })
            .then(response => response.json())
            .then(data => {
                const storyContent = document.getElementById('story-content');
                storyContent.textContent = data.story;
                
                button.disabled = false;
                button.textContent = 'Generate Story';
            })
            .catch(error => {
                console.error('Error:', error);
                button.disabled = false;
                button.textContent = 'Generate Story';
                alert('Error generating story. Please try again.');
            });
        }
    </script>
</body>
</html> 